---
name: æ¨¡å—
icon: material/package-variant-closed
comments: true
---

## æ¨¡å—ã€åŒ…å’Œåº“

- æ¨¡å—: ä¸€å †å‡½æ•°ã€ç±»ã€å˜é‡çš„é›†åˆ
- åŒ…: ä¸€ä¸ªåŒ…å¯èƒ½ç”±å¤šä¸ªæ¨¡å—ç»„æˆ
- åº“: ä¸€ä¸ªåº“å¯èƒ½ç”±å¤šä¸ªåŒ…å’Œæ¨¡å—ç»„æˆ

### æ¨¡å—

ä»¥`.py`ä¸ºåç¼€çš„æ–‡ä»¶, ç§°ä¹‹ä¸ºæ¨¡å—. 

???+ example "ä¾‹å­"

    å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåä¸ºdemo.pyçš„æ–‡ä»¶: 

    ```py
    name = "wenzexu"
    print("å¯¼å…¥æˆåŠŸ")
    ```

    ç›´æ¥ä½¿ç”¨`import`è¯­å¥å°±èƒ½å¯¼å…¥, å¯¼å…¥ä¹‹å, å¯ä»¥ä½¿ç”¨`æ¨¡å—å.å˜é‡å`çš„æ–¹å¼è®¿é—®è¿™ä¸ªå˜é‡:

    ```
    >>> import demo
    å¯¼å…¥æˆåŠŸ # ç”±äºæœªå®šä¹‰__name__, å¯¼è‡´é¡¶å±‚ä»£ç æ‰§è¡Œ
    >>> demo.name
    'wenzexu'
    ```

???+ warning "æ³¨æ„"

    åœ¨å¯¼å…¥æ¨¡å—ä¹‹å, æ¨¡å—ä¹‹å†…æ‰€æœ‰æœªåŒ…è£¹åœ¨å‡½æ•°æˆ–è€…ç±»é‡Œé¢çš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ. å¦‚æœä½ å¸Œæœ›åœ¨å¯¼å…¥åŒ…ä¹‹åä¸æ‰§è¡Œé¡¶å±‚ä»£ç , å¯ä»¥ä½¿ç”¨`__name__`å‚æ•°. è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å†…ç½®å˜é‡, ä¸€ä¸ªæ–‡ä»¶è¢«ç›´æ¥è¿è¡Œçš„æ—¶å€™, å…¶å†…éƒ¨çš„`__name__`ä¼šè¢«è§£é‡Šå™¨è®¾ä¸º`__main__`; ä¸€ä¸ªæ–‡ä»¶è¢«ä½œä¸ºæ¨¡å—å¯¼å…¥çš„æ—¶å€™, `__name__`çš„å€¼è¢«è®¾ç½®ä¸ºè¯¥æ¨¡å—çš„åå­—.

    ???+ example "ä¾‹å­"

        å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåä¸ºdemo.pyçš„æ–‡ä»¶:

        ```py
        name = "wenzexu"

        def main():
            print("å¯¼å…¥æˆåŠŸ")
            print(__name__)

        if __name__ == "__main__":
            main()
        ```

        è¿è¡Œdemo.py:

        ```sh
        $ python demo.py
        å¯¼å…¥æˆåŠŸ
        __main__
        ```

        åœ¨å¦ä¸€ä¸ªæ–‡ä»¶run.pyå¯¼å…¥è¿™ä¸ªdemo.pyæ¨¡å—: 

        ```py
        import demo
        print(demo.name)
        ```

        è¿è¡Œrun.py:

        ```sh
        $ python run.py
        wenzexu
        demo
        ```

    ???+ tip "Tip"

        å¯ä»¥ä½¿ç”¨`python`å‘½ä»¤çš„`-m`é€‰é¡¹ç”¨äºç›´æ¥è¿è¡Œæ¨¡å—, è¯¥é€‰é¡¹åæ¥æ¨¡å—å. å½“ä½ ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ä¹‹å, è§£é‡Šå™¨å°†åˆ¶å®šçš„æ¨¡å—ä½œä¸ºè„šæœ¬æ‰§è¡Œ, è€Œä¸ä»…ä»…æ˜¯å¯¼å…¥å®ƒ. è¿™æ„å‘³ç€æ¨¡å—ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ, åŒ…æ‹¬é¡¶å±‚ä»£ç , å³è¢«`if __name__ == "__main__"`ä¿æŠ¤çš„ä»£ç å—. 

???+ tip "Tip"

    å½“æ¨¡å—è¢«å¯¼å…¥ä¹‹å, ä¼šåœ¨å½“å‰ç›®å½•ä¸‹äº§ç”Ÿä¸€ä¸ªå«åš`__pycache__`çš„ç¼“å­˜æ–‡ä»¶å¤¹. è¿™é‡Œé¢çš„æ–‡ä»¶æ˜¯æ¨¡å—è¢«å¯¼å…¥ä¹‹åè§£é‡Šå™¨æ ¹æ®æ¨¡å—ä»£ç ç¼–è¯‘ç”Ÿæˆçš„å­—èŠ‚ç . è¿™æ ·å¦‚æœä»¥åå†æ¬¡è¿è¡Œçš„è¯. å¦‚æœè°ƒç”¨çš„æ¨¡å—æœªå‘ç”Ÿæ”¹å˜, é‚£å°±ç›´æ¥è·³è¿‡ç¼–è¯‘è¿™ä¸€æ­¥, ç›´æ¥å»`__pycache__`æ–‡ä»¶å¤¹é‡Œå»è¿è¡Œç›¸å…³çš„`*.pyc`æ–‡ä»¶, å¤§å¤§ç¼©çŸ­äº†é¡¹ç›®è¿è¡Œå‰çš„å‡†å¤‡æ—¶é—´.

    ???+ example "ä¾‹å­"

        ```sh
        $ tree .
        .
        â”œâ”€â”€ __pycache__
        â”‚Â Â  â””â”€â”€ demo.cpython-312.pyc
        â”œâ”€â”€ demo.py
        â””â”€â”€ run.py
        ```

#### ä½œç”¨åŸŸ

åœ¨ä¸€ä¸ªæ¨¡å—ä¸­, æˆ‘ä»¬å¯èƒ½å®šä¹‰å¾ˆå¤šçš„å‡½æ•°å’Œå˜é‡, æœ‰çš„å‡½æ•°å’Œå˜é‡æˆ‘ä»¬å¸Œæœ›ç»™åˆ«äººä½¿ç”¨, æœ‰çš„å‡½æ•°å’Œå˜é‡æˆ‘ä»¬å¸Œæœ›ä»…ä»…åœ¨æ¨¡å—å†…éƒ¨ä½¿ç”¨, è¿™å¯ä»¥é€šè¿‡`_`å‰ç¼€å®ç°. 

???+ example "ä¾‹å­"

    ```py
    def _private_1(name):
    return 'Hello, %s' % name

    def _private_2(name):
        return 'Hi, %s' % name

    def greeting(name):
        if len(name) > 3:
            return _private_1(name)
        else:
            return _private_2(name)
    ```

???+ warning "æ³¨æ„"

    è¿™ç§å‡½æ•°æ˜¯"ä¸åº”è¯¥"è¢«ç›´æ¥å¼•ç”¨, è€Œä¸æ˜¯"ä¸èƒ½"è¢«ç›´æ¥å¼•ç”¨, è¿™æ˜¯ä¸€ç§çº¦å®šä¿—ç§°çš„æ–¹æ³•, å‘Šè¯‰å¼€å‘è€…è¿™ä¸ªå‡½æ•°ä¸èƒ½å¼•ç”¨. åœ¨å®ä¾‹å˜é‡/å‡½æ•°çš„[è®¿é—®é™åˆ¶](/åŸºç¡€/å¯¹è±¡/#è®¿é—®é™åˆ¶)ä¹Ÿæåˆ°è¿‡è¿™ä¸ªæ¦‚å¿µ. 

### åŒ…

#### å¸¸è§„åŒ…

åœ¨Python3.3ä¹‹å‰, ä¸€ä¸ªåŒ…æƒ³è¦è¢«å¯¼å…¥ä½¿ç”¨, åŒ…å†…å¿…é¡»è¦æœ‰`__init__.py`æ–‡ä»¶, è¿™ä¸ªæ˜¯Pythonè¯†åˆ«ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜¯å¦ä¸ºä¸€ä¸ªåŒ…çš„é‡è¦æ ‡å¿—.

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„: 

    ```
    demo/
    â”œâ”€â”€ bar
    â”‚   â””â”€â”€ __init__.py
    â”œâ”€â”€ foo
    â”‚   â””â”€â”€ __init__.py
    â””â”€â”€ __init__.py
    ```

    ç°åœ¨, æŠŠ`demo`ä¸‹çš„`__init__.py`åˆ é™¤, æ‰§è¡Œè¯­å¥: 

    ```
    >>> import demo
    Traceback (most recent call last):
        File "<stdin>", line 1, in <module>
    ImportError: No module named demo
    ```

#### å‘½åç©ºé—´åŒ…

åœ¨Python3.3ä¹‹å, å³ä½¿ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æ²¡æœ‰å®šä¹‰`__init__.py`, ä¹Ÿå¯ä»¥è¢«ä½œä¸ºå‘½åç©ºé—´åŒ…çš„å½¢å¼å¯¼å…¥.

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„:

    ```
    demo/
    â”œâ”€â”€ bar
    â”‚   â””â”€â”€ __init__.py
    â””â”€â”€ foo
        â””â”€â”€ __init__.py
    ```

    å°è¯•å¯¼å…¥`demo`: 

    ```
    >>> import demo
    ```

    å¹¶æ²¡æœ‰æŠ¥é”™

### åº“

åº“æ˜¯ä¸€å®šåŠŸèƒ½ä»£ç çš„é›†åˆ, é€šå¸¸è®¤ä¸ºä»–æ˜¯ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®æ‰“åŒ….

## å¯¼å…¥

### æœç´¢è·¯å¾„ {#æœç´¢è·¯å¾„}

å½“æˆ‘ä»¬å¯¼å…¥åŒ…æˆ–è€…æ¨¡å—çš„æ—¶å€™, Pythonè§£é‡Šå™¨ä¼šåœ¨è¿™ä¸¤ä¸ªåœ°æ–¹å¯»æ‰¾åŒ…æˆ–è€…æ¨¡å—:

1. `sys.path`
2. è¿è¡Œæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•

???+ tip "Tip"

    å¯ä»¥é€šè¿‡`sys`æ¨¡å—æŸ¥çœ‹`sys.path`.

    ???+ example "ä¾‹å­"

        ```
        >>> import sys
        >>> sys.path
        ['', '/usr/lib64/python39.zip', '/usr/lib64/python3.9', '/usr/lib64/python3.9/lib-dynload', '/usr/lib64/python3.9/site-packages', '/usr/lib/python3.9/site-packages']
        ```

### `import`

`import`åªèƒ½ç”¨äºå¯¼å…¥åŒ…æˆ–è€…æ¨¡å—, ä¸èƒ½å¯¼å…¥æ¨¡å—å†…éƒ¨çš„å˜é‡/å‡½æ•°/ç±». ä½¿ç”¨å†…éƒ¨å˜é‡/å‡½æ•°/ç±»çš„æ—¶å€™è¦åŠ åŒ…æˆ–è€…æ¨¡å—çš„å‰ç¼€.

- `import [module]`
    - `import [module] as [alias]`
- `import [package].[module]`
    - `import [package].[module] as [alias]`
- `import [package]`: è¯¦è§[å¯¼å…¥åŒ…](#init.pyæ˜¯ä¸€ä¸ªæ¨¡å—)
- `import [package].[subpackage]`: è¯¦è§[å¯¼å…¥åŒ…](#init.pyæ˜¯ä¸€ä¸ªæ¨¡å—)

    ???+ warning "æ³¨æ„"

        è¿™ç§æƒ…å†µä¸‹åŠ è½½çš„å…¶å®æ˜¯åŒ…ä¸‹çš„`__init__.py`æ–‡ä»¶. 

        ??? example "ä¾‹å­"

            ç›®å½•ç»“æ„:

            ```sh
            .
            â”œâ”€â”€ pac
            â”‚Â Â  â”œâ”€â”€ __init__.py
            â”‚Â Â  â””â”€â”€ demo.py
            â””â”€â”€ run.py
            ```

            `__init__.py`æ–‡ä»¶:

            ```py
            print("hello")
            print(__name__)
            ```

            `run.py`æ–‡ä»¶:

            ```py
            import pac
            ```

            æ‰§è¡Œ`run.py`

            ```sh
            $ python run.py
            hello
            demo
            ```

???+ example "ä¾‹å­"

    === "ä¾‹å­1"

        ç›®å½•ç»“æ„:

        ```sh
        .
        â”œâ”€â”€ demo.py
        â””â”€â”€ run.py
        ```

        `demo.py`æ–‡ä»¶: 

        ```py
        name = "wenzexu"

        def main():
            print("å¯¼å…¥æˆåŠŸ")
            print(__name__)

        if __name__ == "__main__":
            main()
        ```

        `run.py`æ–‡ä»¶:

        ```py
        import demo

        print(demo.name)
        ```

        æ‰§è¡Œ`run.py`: 

        ```sh
        $ python run.py
        wenzexu
        ```
    
    === "ä¾‹å­2"

        ç›®å½•ç»“æ„:

        ```sh
        .
        â”œâ”€â”€ pac
        â”‚Â Â  â”œâ”€â”€ __init__.py
        â”‚Â Â  â””â”€â”€ demo.py
        â””â”€â”€ run.py 
        ```

        `demo.py`æ–‡ä»¶:

        ```py
        name = "wenzexu"

        def main():
            print("å¯¼å…¥æˆåŠŸ")
            print(__name__)

        if __name__ == "__main__":
            main()
        ```

        `run.py`æ–‡ä»¶:

        ```py
        import pac.demo

        print(pac.demo.name) 
        ```

        è¿è¡Œ`run.py`:

        ```sh
        $ python run.py
        wenzexu
        ```

### `from ... import ...`

`from ... import ...`å¯ä»¥ç”¨äºå¯¼å…¥æ¨¡å—, ä»¥åŠæ¨¡å—ä¸­çš„å˜é‡/å‡½æ•°/ç±», ä½†æ˜¯ä¸èƒ½ç”¨äºå¯¼å…¥åŒ…. å¦‚æœå¯¼å…¥çš„æ˜¯æ¨¡å—, ä½¿ç”¨å†…éƒ¨å˜é‡/å‡½æ•°/ç±»çš„æ—¶å€™è¦åŠ ä¸Šå‰ç¼€.

- `from [package] import [module]`
- `from [module] import [var, function, class]`
- `from [package].[module] import [var, function, class]`
- `from [package].[module] import [var, function, class], [var, function, class]`
- `from [package].[module] import *` 
- `from [package].[subpackage] import [module]`
- `from [package] import *`
- `from [package] import [var, function, class]`

???+ example "ä¾‹å­"

    === "ä¾‹å­1"

        ç›®å½•ç»“æ„:

        ```sh
        .
        â”œâ”€â”€ pac
        â”‚Â Â  â”œâ”€â”€ __init__.py
        â”‚Â Â  â””â”€â”€ demo.py
        â””â”€â”€ run.py 
        ```

        `demo.py`æ–‡ä»¶: 

        ```py
        from pac.demo import name
        
        print(name)
        ```

        `run.py`æ–‡ä»¶:

        ```py
        name = "wenzexu"
        ```

        è¿è¡Œ`run.py`æ–‡ä»¶:

        ```sh
        $ python run.py
        wenzexu
        ```
    
    === "ä¾‹å­2"

        ç›®å½•ç»“æ„:

        ```sh
        .
        â”œâ”€â”€ pac
        â”‚Â Â  â”œâ”€â”€ __init__.py
        â”‚Â Â  â””â”€â”€ demo.py
        â””â”€â”€ run.py 
        ```

        `demo.py`æ–‡ä»¶: 

        ```py
        from pac import demo
        
        print(demo.name)
        ```

        `run.py`æ–‡ä»¶:

        ```py
        name = "wenzexu"
        ```

        è¿è¡Œ`run.py`æ–‡ä»¶:

        ```sh
        $ python run.py
        wenzexu
        ```

#### ç»å¯¹å¯¼å…¥å’Œç›¸å¯¹å¯¼å…¥

ç»å¯¹å¯¼å…¥æŒ‡çš„æ˜¯ä»æ ¹ç›®å½•å¼€å§‹å¯¼å…¥æ¨¡å—. ç›¸å¯¹å¯¼å…¥æŒ‡çš„æ˜¯ä»å½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¼€å§‹å¯¼å…¥æ¨¡å—. 

ç›¸å¯¹å¯¼å…¥çš„å†™æ³•ä¸º:

- `from . import [module]`
- `from .[package] import [module]`
- `from .. import [module]`
- `from ..[package] import [module]`
- `from . import [package]`
- `from . import [package].[module]`

???+ example "ä¾‹å­"

    === "ä¾‹å­1"

        ç›®å½•ç»“æ„:

        ```py
        .
        â”œâ”€â”€ a.py
        â”œâ”€â”€ b.py
        â””â”€â”€ step
            â”œâ”€â”€ c.py
            â””â”€â”€ d.py
        ```

        `c.py`æ–‡ä»¶å†…å®¹: 

        ```py
        import d # åœ¨Python3ä¸­å¯¼è‡´æŠ¥é”™

        def printSelf():
            print("In c")
        ```

        `a.py`æ–‡ä»¶å†…å®¹:

        ```py
        from step import c

        c.printSelf()
        ```

        ä¸Šè¿°è¿è¡Œ`a.py`ä¹‹åä¼šæŠ¥é”™, å› ä¸º`a.py`å¯¼å…¥`c.py`ä¹‹å, å†è¦å¯¼å…¥`d.py`, ç”±äº`a.py`å’Œ`d.py`åœ¨ä¸åŒçš„ç›®å½•ä¸‹, æ‰€ä»¥`c.py`å¯¼å…¥`d.py`çš„æ—¶å€™ä¼šæŠ¥é”™. ä¸Šè¿°çš„å†™æ³•åœ¨Python2é‡Œé¢æ²¡é—®é¢˜, ä½†æ˜¯åœ¨Python3é‡Œé¢ä¼šæŠ¥é”™. å› ä¸ºè¿™ç§å†™æ³•åœ¨Python2é‡Œé¢æ˜¯ç›¸å¯¹å¯¼å…¥, åœ¨Python3é‡Œé¢æ˜¯ç»å¯¹å¯¼å…¥. 

    === "ä¾‹å­2"

        ç›®å½•ç»“æ„:

        ```py
        .
        â”œâ”€â”€ a.py
        â”œâ”€â”€ b.py
        â””â”€â”€ step
            â”œâ”€â”€ c.py
            â””â”€â”€ d.py
        ```

        `c.py`æ–‡ä»¶å†…å®¹: 

        ```py
        from . import d # é‡‡ç”¨ç›¸å¯¹å¯¼å…¥çš„å†™æ³•

        def printSelf():
            print("In c")
        ```

        `a.py`æ–‡ä»¶å†…å®¹:

        ```py
        from step import c

        c.printSelf()
        ```

        è¿è¡Œ`a.py`:

        ```sh
        $ python a.py
        In c
        ```

        è¿™æ ·ä½¿ç”¨ç›¸å¯¹å¯¼å…¥å°±æ²¡é—®é¢˜äº†.

## `__package__`å±æ€§ {#packageå±æ€§}

`__package__`å±æ€§ç”¨äºæ ‡è¯†æ¨¡å—æ‰€å±çš„åŒ…, å®ƒåœ¨ä¸€ä¸ªæ¨¡å—çš„å€¼æ˜¯è¿™æ ·ç¡®å®šçš„

- å½“è¿™ä¸ªæ¨¡å—æ˜¯è¢«ä½œä¸ºåŒ…çš„ä¸€éƒ¨åˆ†å¯¼å…¥çš„æ—¶å€™, è¿™ä¸ªæ¨¡å—å†…çš„`__package__`æ˜¯åŒ…çš„åç§°
- å½“è¿™ä¸ªæ¨¡å—æ˜¯æ²¡æœ‰è¢«ä½œä¸ºåŒ…çš„ä¸€éƒ¨åˆ†å¯¼å…¥çš„æ—¶å€™, è¿™ä¸ªæ¨¡å—å†…çš„`__package__`æ˜¯ç©ºå­—ç¬¦ä¸²
- å½“è¿™ä¸ªæ¨¡å—æ˜¯è¢«ç›´æ¥æ‰§è¡Œçš„æ—¶å€™, è¿™ä¸ªæ¨¡å—å†…çš„`__package__`æ˜¯`None`

???+ example "ä¾‹å­"

    === "`module.py`ä½œä¸ºåŒ…çš„ä¸€éƒ¨åˆ†è¢«å¯¼å…¥"

        ç›®å½•ç»“æ„:

        ```
        .
        â”œâ”€â”€ main
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ module.py
        â””â”€â”€ test.py
        ```

        `test.py`æ–‡ä»¶:

        ```py
        import main.module
        ```

        `module.py`æ–‡ä»¶:

        ```py
        print(__package__)
        ```

        æ‰§è¡Œ: 

        ```
        $ python test.py
        main
        ```
    
    === "`module.py`ä¸ä½œä¸ºåŒ…çš„ä¸€éƒ¨åˆ†å¯¼å…¥è¢«å¯¼å…¥"

        ç›®å½•ç»“æ„:

        ```
        .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â”œâ”€â”€ module.py
            â””â”€â”€ test.py
        ```

        `test.py`æ–‡ä»¶:

        ```py
        import module
        ```

        `module.py`æ–‡ä»¶:

        ```py
        print(__package__)
        ```

        æ‰§è¡Œ: 

        ```
        $ python test.py
        ''
        ```

    === "`module.py`ç›´æ¥è¢«æ‰§è¡Œ"

        ç›®å½•ç»“æ„:

        ```
        .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â””â”€â”€ module.py
        ```

        `module.py`æ–‡ä»¶:

        ```py
        print(__package__)
        ```

        æ‰§è¡Œ: 

        ```
        $ python module.py
        None
        ```

### `__package__`å±æ€§å’Œç›¸å¯¹å¯¼å…¥

å½“é‡åˆ°ç›¸å¯¹å¯¼å…¥çš„æ—¶å€™, å½“å‰æ¨¡å—ä¼šå°†è‡ªå·±çš„`__package__`åšä¸ºåŸºç¡€, åœ¨è¿™ä¸ªä¹‹ä¸Šå¯¹è·¯å¾„åšæ‹¼æ¥æˆ–è€…åˆ é™¤, ä»è€Œæ‰¾åˆ°å¯¹åº”çš„æ¨¡å—.

???+ example "ä¾‹å­"

    === "ä¾‹å­1"

        ç›®å½•ç»“æ„:

        ```
        .
        â”œâ”€â”€ main
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â”œâ”€â”€ module.py
        â”‚   â””â”€â”€ test
        â”‚       â”œâ”€â”€ __init__.py
        â”‚       â””â”€â”€ module1.py
        â””â”€â”€ out.py
        ```

        `module.py`æ–‡ä»¶: 

        ```py
        from .test import module1

        print(__package__)
        module1.hello()
        ```

        `module1.py`æ–‡ä»¶:

        ```py
        def hello():
            print('Hello from module1.py')
        ```

        `out.py`æ–‡ä»¶:

        ```py
        import main.module
        ```

        æ‰§è¡Œ: 

        ```
        $ python out.py
        main
        Hello from module1.py
        ```

        è§£é‡Š: `module.py`æ–‡ä»¶è¢«ä½œä¸º`main`åŒ…çš„ä¸€éƒ¨åˆ†å¯¼å…¥, æ‰€ä»¥`module.py`æ¨¡å—å†…çš„`__package__`æ˜¯`main`. é‡Œé¢çš„ç›¸å¯¹å¯¼å…¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåšæ‹¼æ¥: `main/test`, æœ€ç»ˆæ‰¾åˆ°äº†`module1.py`.

    === "ä¾‹å­2"

        ç›®å½•ç»“æ„:

        ```
        .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â”œâ”€â”€ module.py
            â””â”€â”€ test
                â”œâ”€â”€ __init__.py
                â””â”€â”€ module1.py
        ```

        `module.py`æ–‡ä»¶: 

        ```py
        from .test import module1

        module1.hello()
        ```

        `module1.py`æ–‡ä»¶:

        ```py
        def hello():
            print('Hello from module1.py')
        ```

        æ‰§è¡Œ: 

        ```
        $ python module.py
        Traceback (most recent call last):
            File "/home/wenzexu/test/main/module.py", line 1, in <module>
                from .test import module1
        ImportError: attempted relative import with no known parent package
        ```

        å‡ºé”™çš„åŸå› æ˜¯: `module.py`ç”±äºæ˜¯ç›´æ¥æ‰§è¡Œçš„, æ‰€ä»¥å…¶`__package__`ä¸º`None`, æ‰€ä»¥è§£é‡Šå™¨æ— æ³•åœ¨`None`ä¸Šåšæ‹¼æ¥, æ‰€ä»¥æ— æ³•æ‰¾åˆ°å¯¹åº”æ¨¡å—.

## `__init__.py`æ–‡ä»¶

`__init__.py`æ–‡ä»¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶, ä¸»è¦ç”¨äºæ ‡è¯†æŸä¸ªç›®å½•æ˜¯ä¸€ä¸ªPythonåŒ…, å®ƒçš„ä¸»è¦ä½œç”¨ä¸ä»…ä»…åªæ˜¯æ ‡è¯†åŒ…, è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½, ä¸‹é¢ä¼šä¸€ä¸€è¯´æ˜.

### `__init__.py`æ˜¯ä¸€ä¸ªæ¨¡å— {#init.pyæ˜¯ä¸€ä¸ªæ¨¡å—}

???+ danger "ç‰¹åˆ«æ³¨æ„"

    - å¯¼å…¥åŒ…, å°±æ˜¯å¯¼å…¥å®ƒçš„`__init__.py`æ¨¡å—.
    - ç¬¬ä¸€æ¬¡å¯¼å…¥åŒ…çš„æ—¶å€™, å…¶`__init__.py`ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œ.
    - `import`è¯­å¥æˆ–è€…`from ... import ...`ä¸­å‡ºç°çš„åŒ…çš„`__init__.py`æ¨¡å—åœ¨ç¬¬ä¸€æ¬¡å¯¼å…¥çš„æ—¶å€™éƒ½ä¼šè¢«æ‰§è¡Œ
    - æ‰€æœ‰è¢«å¯¼å…¥çš„æ¨¡å—éƒ½ä¼šè¢«æ”¾åœ¨`sys.modules`ä¸­, é‡å¤å¯¼å…¥è¿™äº›æ¨¡å—ä¸ä¼šè¢«æ‰§è¡Œ, åŒ…æ‹¬`__init__.py`

???+ warning "æ³¨æ„"

    åŒ…ä¸­çš„`__init__.py`æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ¨¡å—, åœ¨ç›´æ¥å¯¼å…¥åŒ…çš„æ—¶å€™, å¦‚`import [package]`çš„æ—¶å€™, è¿™ä¸ª`__init__.py`çš„æ¨¡å—ä¼šè¢«é»˜è®¤å¯¼å…¥, æˆ‘ä»¬å¯¼å…¥ä¹‹åå¯ä»¥æŸ¥çœ‹`sys.modules`, å‘ç°å…¶å®`__init__.py`è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªè¢«å¯¼å…¥çš„æ¨¡å—.


    ???+ example "ä¾‹å­"

        ç›®å½•ç»“æ„:

        ```
         .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â”œâ”€â”€ test1
            â”‚   â”œâ”€â”€ __init__.py
            â”‚   â””â”€â”€ module1.py
            â””â”€â”€ test2
                â”œâ”€â”€ __init__.py
                â””â”€â”€ module2.py
        ```

        `main/__init__.py`æ–‡ä»¶:

        ```py
        import sys

        print('parent package was called')
        print(sys.modules)
        ```

        åœ¨`main`çš„ä¸Šçº§æ–‡ä»¶å¤¹æ‰§è¡Œ: 

        ```
        >>> import main
        parent package was called
        {[çœç•¥]'main': <module 'main' from '/home/wenzexu/test/main/__init__.py'>}
        >>> import main
        >>>
        ```

### åˆå§‹åŒ–åŒ…

å½“åŒ…ç¬¬ä¸€æ¬¡è¢«å¯¼å…¥çš„æ—¶å€™, ç›¸å½“äºå¯¼å…¥çš„æ˜¯`__init__.py`æ¨¡å—, `__init__.py`æ–‡ä»¶ä¸­çš„ä»£ç ä¼šè¢«ç«‹å³æ‰§è¡Œ, å¯ä»¥åœ¨æ­¤æ–‡ä»¶ä¸­åˆå§‹åŒ–åŒ…, è®¾ç½®ä¸€äº›åŒ…çº§åˆ«çš„å˜é‡æˆ–è€…æ‰§è¡ŒåŒ…çº§åˆ«çš„åˆå§‹åŒ–æ“ä½œ.

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„:

    ```
    .
    â””â”€â”€ main
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ test1
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ module1.py
        â””â”€â”€ test2
            â”œâ”€â”€ __init__.py
            â””â”€â”€ module2.py
    ```

    `main/__init__.py`æ–‡ä»¶:

    ```py
    print('parent package was called')
    ```

    åœ¨`main`çš„ä¸Šçº§æ–‡ä»¶å¤¹æ‰§è¡Œ: 

    ```
    >>> import main
    parent package was called
    >>> import main
    >>>
    ```

    ???+ tip "Tip"

        ç¬¬ä¸€æ¬¡å¯¼å…¥å, å¯¼å…¥çš„`__init__.py`æ¨¡å—ä¼šè¢«æ”¾åœ¨`sys.modules`ä¸­, éšåå¦‚æœå†å¯¼å…¥, `__init__.py`æ–‡ä»¶å°†ä¸ä¼šå†æ‰§è¡Œ. 

### é€’å½’åŒ…ç»“æ„

åœ¨åŒ…å«å­åŒ…çš„å¤æ‚åŒ…ç»“æ„ä¸­, æ¯ä¸ªå­åŒ…ç›®å½•ä¸­ä¹Ÿéœ€è¦åŒ…å«ä¸€ä¸ª`__init__.py`æ–‡ä»¶.

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„:

    ```
    .
    â””â”€â”€ main
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ test1
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ module1.py
        â””â”€â”€ test2
            â”œâ”€â”€ __init__.py
            â””â”€â”€ module2.py
    ```

    `main/__init__.py`æ–‡ä»¶:

    ```py
    print('parent package was called')
    ```

    `main/test1/__init__.py`æ–‡ä»¶:

    ```py
    print('test1 was called')
    ```

    åœ¨`main`çš„ä¸Šçº§æ–‡ä»¶å¤¹æ‰§è¡Œ: 

    ```
    >>> import main.test1
    parent package was called
    test1 was called
    >>> import main.test1
    >>>
    ```

### æ§åˆ¶åŒ…çš„å¯¼å…¥è¡Œä¸º

é€šè¿‡åœ¨`__init__.py`ä¸­å®šä¹‰`__all__`å˜é‡, å¯ä»¥æ§åˆ¶`from [package] import *`è¯­å¥çš„å¯¼å…¥è¡Œä¸º.

???+ example "ä¾‹å­"

    === "ä¾‹å­1"

        ç›®å½•ç»“æ„:

        ```
        .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â”œâ”€â”€ test1
            â”‚   â”œâ”€â”€ __init__.py
            â”‚   â””â”€â”€ module1.py
            â””â”€â”€ test2
                â”œâ”€â”€ __init__.py
                â””â”€â”€ module2.py
        ```

        `main/__init__.py`æ–‡ä»¶:

        ```py
        print('parent package was called')
        __all__ = ['test1']
        ```

        `main/test1/__init__.py`æ–‡ä»¶:

        ```py
        print('test1 was called')
        ```

        `main/test1/module1.py`æ–‡ä»¶:

        ```py
        print('module1 was called')
        ```

        `main/test2/__init__.py`æ–‡ä»¶:

        ```py
        print('test2 was called')
        ```

        `main/test2/module2.py`æ–‡ä»¶:

        ```py
        print('module2 was called')
        ```

        åœ¨`main`çš„ä¸Šçº§æ–‡ä»¶å¤¹æ‰§è¡Œ: 

        ```
        >>> from main import *
        parent package was called
        test1 was called
        >>> import main
        >>>
        ```
        
        è§£é‡Š: 

        1. ç¬¬ä¸€æ¬¡ä»`main`åŒ…æ‰§è¡Œå¯¼å…¥`from main import *`
        2. `main`åŒ…çš„`__init__.py`æ¨¡å—è‡ªåŠ¨æ‰§è¡Œ
        3. `__all__`å®šä¹‰ä¸º`test1`åŒ…
        4. ç¬¬ä¸€æ¬¡ä»`test1`åŒ…æ‰§è¡Œå¯¼å…¥`import test1`
        5. `test1`åŒ…çš„`__init__.py`æ¨¡å—è‡ªåŠ¨æ‰§è¡Œ
    
    === "ä¾‹å­2"

        ç›®å½•ç»“æ„:

        ```
        .
        â””â”€â”€ main
            â”œâ”€â”€ __init__.py
            â”œâ”€â”€ test1
            â”‚   â”œâ”€â”€ __init__.py
            â”‚   â””â”€â”€ module1.py
            â””â”€â”€ test2
                â”œâ”€â”€ __init__.py
                â””â”€â”€ module2.py
        ```

        `main/__init__.py`æ–‡ä»¶:

        ```py
        print('parent package was called')
        __all__ = ['test1']
        ```

        `main/test1/__init__.py`æ–‡ä»¶:

        ```py
        from . import module1
        print('test1 was called')
        ```

        `main/test1/module1.py`æ–‡ä»¶:

        ```py
        print('module1 was called')
        ```

        `main/test2/__init__.py`æ–‡ä»¶:

        ```py
        print('test2 was called')
        ```

        `main/test2/module2.py`æ–‡ä»¶:

        ```py
        print('module2 was called')
        ```

        åœ¨`main`çš„ä¸Šçº§æ–‡ä»¶å¤¹æ‰§è¡Œ: 

        ```
        >>> from main import *
        parent package was called
        module1 was called
        test1 was called
        >>> import main
        >>>
        ```
        
        è§£é‡Š: 

        1. ç¬¬ä¸€æ¬¡ä»`main`åŒ…æ‰§è¡Œå¯¼å…¥`from main import *`
        2. `main`åŒ…çš„`__init__.py`æ¨¡å—è‡ªåŠ¨æ‰§è¡Œ
        3. `__all__`å®šä¹‰ä¸º`test1`åŒ…
        4. ç¬¬ä¸€æ¬¡ä»`test1`åŒ…æ‰§è¡Œå¯¼å…¥`import test1`
        5. `test1`åŒ…çš„`__init__.py`æ¨¡å—è‡ªåŠ¨æ‰§è¡Œ
        6. æ‰§è¡Œ`test1`åŒ…çš„`__init__.py`æ—¶å‘ç°è¦å¯¼å…¥`module1`æ¨¡å—, æ‰§è¡Œ`module1`æ¨¡å—

## `__main__.py`æ–‡ä»¶

`__main__.py`æ–‡ä»¶çš„ä½œç”¨æ˜¯ä½œä¸ºä¸€ä¸ªåŒ…çš„å…¥å£ç‚¹, ä½¿å¾—åŒ…å¯ä»¥åƒè„šæœ¬ä¸€æ ·ç›´æ¥è¿è¡Œ. å½“ä½¿ç”¨`python -m [package]`æ—¶, `[package]`å†…çš„`__main__.py`æ¨¡å—ä¼šè‡ªåŠ¨æ‰§è¡Œ.

### æ‰§è¡ŒåŒ…

å½“æˆ‘ä»¬ä½¿ç”¨`python -m [åŒ…]`è¿è¡ŒåŒ…çš„æ—¶å€™, ä¼šå…ˆæ‰§è¡ŒåŒ…å†…çš„`__init__.py`ç„¶åæ‰§è¡Œ`__main__.py`. 

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„:  

    ```
    .
    â””â”€â”€ pkg
        â”œâ”€â”€ __init__.py
        â””â”€â”€ __main__.py
    ```

    `__init__.py`æ–‡ä»¶:

    ```py
    import sys
    print('__init__')
    print('__init__.__name__', __name__)
    print('__init__.__package__', __package__)
    print('sys.path', sys.path)
    def hello():
        print("Hello from pkg/__init__.py")
    ```

    `__main__.py`æ–‡ä»¶:

    ```py
    import sys
    print('__main__')
    print('__main__.__name__', __name__)
    print('__main__.__package__', __package__)
    print('sys.path', sys.path)
    import pkg
    pkg.hello()
    ```

    åœ¨`pkg`æ–‡ä»¶å¤¹å¤–æ‰§è¡Œ: 

    ```
    $ python -m pkg 
    __init__
    __init__.__name__ pkg
    __init__.__package__ pkg
    sys.path ['/Users/wenzexu/test', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/wenzexu/test/.venv/lib/python3.12/site-packages']
    __main__
    __main__.__name__ __main__
    __main__.__package__ pkg
    sys.path ['/Users/wenzexu/test', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/wenzexu/test/.venv/lib/python3.12/site-packages']
    Hello from pkg/__init__.py
    ```

    ???+ question "ç–‘é—®"

        `__main__.py`åº”è¯¥æ˜¯ç›´æ¥è¢«è¿è¡Œçš„, æ‰€ä»¥`__name__`æ˜¯`__main__`. é€šå¸¸æƒ…å†µä¸‹, è„šæœ¬ç›´æ¥æ‰§è¡Œä¼šå¯¼è‡´å…¶`__package__`ä¸º`None`, è¯¦æƒ…è§[è¿™é‡Œ](#packageå±æ€§). ä½†æ˜¯è¿™é‡Œä¸ç›´æ¥æ‰§è¡Œè„šæœ¬æ—¶ç¨æœ‰ä¸åŒ, è¿™é‡ŒPythonè§£é‡Šå™¨å·²ç»çŸ¥é“`__main__.py`æ˜¯åŒ…çš„ä¸€éƒ¨åˆ†, å¹¶ä¸æ˜¯ä¸€ä¸ªå­¤ç«‹çš„è„šæœ¬, æ‰€ä»¥è¿™é‡Œçš„`__package__`å±æ€§ä¼šè®¾ç½®ä¸º`pkg`.

### æ‰§è¡Œæ–‡ä»¶å¤¹

å½“æˆ‘ä»¬ä½¿ç”¨`python [æ–‡ä»¶å¤¹]`æ‰§è¡Œæ–‡ä»¶å¤¹çš„æ—¶å€™, åªä¼šæ‰§è¡Œæ–‡ä»¶å¤¹å†…çš„`__main__.py`æ–‡ä»¶.

???+ example "ä¾‹å­"

    ç›®å½•ç»“æ„:  

    ```
    .
    â””â”€â”€ pkg
        â”œâ”€â”€ __init__.py
        â””â”€â”€ __main__.py
    ```

    `__init__.py`æ–‡ä»¶:

    ```py
    import sys
    print('__init__')
    print('__init__.__name__', __name__)
    print('__init__.__package__', __package__)
    print('sys.path', sys.path)
    def hello():
        print("Hello from pkg/__init__.py")
    ```

    `__main__.py`æ–‡ä»¶:

    ```py
    import sys
    print('__main__')
    print('__main__.__name__', __name__)
    print('__main__.__package__', __package__)
    print('sys.path', sys.path)
    import pkg
    pkg.hello()
    ```

    åœ¨`pkg`æ–‡ä»¶å¤¹å¤–æ‰§è¡Œ: 

    ```
    $ python pkg 
    __main__
    __main__.__name__ __main__
    __main__.__package__ 
    sys.path ['/Users/wenzexu/test/pkg', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/wenzexu/test/.venv/lib/python3.12/site-packages']
    Traceback (most recent call last):
    File "<frozen runpy>", line 198, in _run_module_as_main
    File "<frozen runpy>", line 88, in _run_code
    File "/Users/wenzexu/test/pkg/__main__.py", line 6, in <module>
        import pkg
    ModuleNotFoundError: No module named 'pkg'
    ```

    ç”±äºæ²¡æœ‰åŠ è½½`pkg`åŒ…, æ‰€ä»¥`sys.path`ä¸­æ²¡æœ‰è¿™ä¸ªåŒ…çš„è·¯å¾„, æ‰€ä»¥`import pkg`å¯¼å…¥å¤±è´¥, æ‰€ä»¥, åªè¦åœ¨`__main__.py`æ–‡ä»¶ä¸­æ‰‹åŠ¨å°†è¿™ä¸ªåŒ…çš„è·¯å¾„åŠ å…¥åˆ°`sys.path`ä¸­å°±å¥½äº†.

    ä¿®æ”¹åçš„`__main__.py`: 

    ```py
    import os, sys
    print('__main__')
    print('__main__.__name__', __name__)
    print('__main__.__package__', __package__)
    if not __package__:
        path = os.path.join(os.path.dirname(__file__), os.pardir)
        sys.path.insert(0, path)
    print('sys.path', sys.path)
    import pkg
    pkg.hello() 
    ```

    åœ¨`pkg`æ–‡ä»¶å¤¹å¤–æ‰§è¡Œ: 

    ```
    $ python pkg
    __main__
    __main__.__name__ __main__
    __main__.__package__ 
    sys.path ['/Users/wenzexu/test/pkg/..', '/Users/wenzexu/test/pkg', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/wenzexu/test/.venv/lib/python3.12/site-packages']
    __init__
    __init__.__name__ pkg
    __init__.__package__ pkg
    sys.path ['/Users/wenzexu/test/pkg/..', '/Users/wenzexu/test/pkg', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/wenzexu/test/.venv/lib/python3.12/site-packages']
    Hello from pkg/__init__.py
    ```

    ç°åœ¨å°±æ­£å¸¸äº†.

## æ‰“åŒ…

æ‰“åŒ…æŒ‡çš„æ˜¯å°†ä¸€ä¸ªé¡¹ç›®æ‰“åŒ…æˆå¯åˆ†å‘çš„æ ¼å¼, ä»¥ä¾¿å…¶ä»–ç”¨æˆ·æˆ–è€…å¼€å‘è€…èƒ½å¤Ÿè½»æ¾å®‰è£…å’Œä½¿ç”¨. æ‰“åŒ…ä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»: 

- åŸåˆ†å‘åŒ…: sdist, åŒ…å«äº†é¡¹ç›®çš„æºä»£ç , é€šå¸¸ä»¥`.tar.gz`æ ¼å¼å‘å¸ƒ, è¿™ç§åŒ…åœ¨å®‰è£…æ—¶éœ€è¦æ ¹æ®æºç è¿›è¡Œæ„å»ºå’Œç¼–è¯‘(å¦‚è¿‡æœ‰éœ€è¦ç¼–è¯‘çš„éƒ¨åˆ†, å¦‚Cæ‰©å±•; å¦‚æœä¸ºçº¯Pythonä»£ç , ä¸éœ€è¦ç¼–è¯‘), å¸¸ç”¨çš„å·¥å…·æ˜¯setuptools
- äºŒè¿›åˆ¶åˆ†å‘åŒ…: bdist, åŒ…å«äº†é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶, é€šå¸¸ä»¥`.whl`æ ¼å¼å‘å¸ƒ, è¿™ç§åŒ…åœ¨å®‰è£…éœ€è¦æ ¹æ®è¿œå—è¿›è¡Œæ„å»º, ä½†æ˜¯ä¸éœ€è¦ç¼–è¯‘(å·²ç»åŒ…å«äº†é¢„ç¼–è¯‘çš„æ–‡ä»¶, æ— è®ºæ˜¯Cæ‰©å±•è¿˜æ˜¯å…¶ä»–äºŒè¿›åˆ¶ä¾èµ–), å¸¸ç”¨çš„å·¥å…·æ˜¯setuptools
- ç‹¬ç«‹å¯æ‰§è¡Œæ–‡ä»¶: è¿™ç§æ–‡ä»¶å°†Pythonä»£ç å’Œè§£é‡Šå™¨ä»¥åŠæœç´¢çš„ä¾èµ–æ‰“åŒ…åœ¨ä¸€èµ·, ç”Ÿæˆä¸€ä¸ªå¯ä»¥åœ¨æ²¡æœ‰è§£é‡Šå™¨çš„ç¯å¢ƒä¸­è¿è¡Œçš„å•ç‹¬å¯æ‰§è¡Œæ–‡ä»¶, å¸¸ç”¨çš„å·¥å…·æœ‰pyinstaller, cx_Freezeå’Œpy2exe

æ­¤å¤–, æˆ‘ä»¬å¯ä»¥é€šè¿‡twineå°†æ‰“åŒ…å¥½çš„åŒ…ä¸Šä¼ åˆ°[PYPI](https://pypi.org).

### `setuptools`æ‰“åŒ…

???+ warning "æ³¨æ„"

    éœ€è¦å…ˆå®‰è£…`setuptools`: `pip install setuptools`.

??? example "ä¾‹å­"

    é¡¹ç›®ç»“æ„:

    ```
    .
    â”œâ”€â”€ LICENSE
    â”œâ”€â”€ MANIFEST.in
    â”œâ”€â”€ README.md
    â”œâ”€â”€ mypackage
    â”‚Â Â  â”œâ”€â”€ __init__.py
    â”‚Â Â  â”œâ”€â”€ __version__.py
    â”‚Â Â  â””â”€â”€ core.py
    â””â”€â”€ setup.py
    ```

    `MANIFEST.in`æ–‡ä»¶: 

    ```
    include README.md LICENSE
    ```

    `__init__.py`æ–‡ä»¶:

    ```py
    from .core import *
    ```

    `__version__.py`æ–‡ä»¶:

    ```py
    # 8b    d8 Yb  dP 88""Yb    db     dP""b8 88  dP    db     dP""b8 888888
    # 88b  d88  YbdP  88__dP   dPYb   dP   `" 88odP    dPYb   dP   `" 88__
    # 88YbdP88   8P   88"""   dP__Yb  Yb      88"Yb   dP__Yb  Yb  "88 88""
    # 88 YY 88  dP    88     dP""""Yb  YboodP 88  Yb dP""""Yb  YboodP 888888

    VERSION = (5, 2, 0)

    __version__ = '.'.join(map(str, VERSION))
    ```

    `core.py`æ–‡ä»¶:

    ```py
    # Insert your code here.
    ```

    `setup.py`æ–‡ä»¶:

    ```py
    #!/usr/bin/env python
    # -*- coding: utf-8 -*-

    # Note: To use the 'upload' functionality of this file, you must:
    #   $ pipenv install twine --dev

    import io
    import os
    import sys
    from shutil import rmtree

    from setuptools import find_packages, setup

    # Package meta-data.
    NAME = '[name]'
    DESCRIPTION = '[desc]'
    URL = 'https://github.com/ricolxwz/[repo]'
    EMAIL = 'ricol.xwz@outlook.com'
    AUTHOR = 'ricolxwz'
    REQUIRES_PYTHON = '>=3.6.0'
    VERSION = '0.1.0'

    # What packages are required for this module to be executed?
    REQUIRED = [
        # 'requests', 'maya', 'records',
    ]

    # What packages are optional?
    EXTRAS = {
        # 'fancy feature': ['django'],
    }

    # The rest you shouldn't have to touch too much :)
    # ------------------------------------------------
    # Except, perhaps the License and Trove Classifiers!
    # If you do change the License, remember to change the Trove Classifier for that!

    here = os.path.abspath(os.path.dirname(__file__))

    # Import the README and use it as the long-description.
    # Note: this will only work if 'README.md' is present in your MANIFEST.in file!
    try:
        with io.open(os.path.join(here, 'README.md'), encoding='utf-8') as f:
            long_description = '\n' + f.read()
    except FileNotFoundError:
        long_description = DESCRIPTION

    # Load the package's __version__.py module as a dictionary.
    about = {}
    if not VERSION:
        project_slug = NAME.lower().replace("-", "_").replace(" ", "_")
        with open(os.path.join(here, project_slug, '__version__.py')) as f:
            exec(f.read(), about)
    else:
        about['__version__'] = VERSION

    # Where the magic happens:
    setup(
        name=NAME,
        version=about['__version__'],
        description=DESCRIPTION,
        long_description=long_description,
        long_description_content_type='text/markdown',
        author=AUTHOR,
        author_email=EMAIL,
        python_requires=REQUIRES_PYTHON,
        url=URL,
        packages=find_packages(exclude=["tests", "*.tests", "*.tests.*", "tests.*"]),
        # If your package is a single module, use this instead of 'packages':
        # py_modules=['mypackage'],

        # entry_points={
        #     'console_scripts': ['mycli=mymodule:cli'],
        # },
        install_requires=REQUIRED,
        extras_require=EXTRAS,
        include_package_data=True,
        license='MIT',
        classifiers=[
            # Trove classifiers
            # Full list: https://pypi.python.org/pypi?%3Aaction=list_classifiers
            'License :: OSI Approved :: MIT License',
            'Programming Language :: Python',
            'Programming Language :: Python :: 3',
            'Programming Language :: Python :: 3.6',
            'Programming Language :: Python :: Implementation :: CPython',
            'Programming Language :: Python :: Implementation :: PyPy'
        ],
    )
    ```

#### åŒ…å†…å®¹

é»˜è®¤æƒ…å†µä¸‹, `setuptools`åœ¨æ„å»ºåŒ…çš„æ—¶å€™ä¼šåŒ…å«ä»¥ä¸‹å†…å®¹: 

1. PythonåŒ…: é€šè¿‡`find_packages()`æ‰¾åˆ°çš„æ‰€æœ‰åŒ…
2. ç”±`package_data`æŒ‡å®šçš„æ–‡ä»¶
3. ç”±`MANIFEST.in`æŒ‡å®šçš„æ–‡ä»¶

???+ warning "æ³¨æ„"

    ä½¿ç”¨åä¸¤ç§æ–¹æ³•å¿…é¡»è¦è®¾ç½®`include_package_data = True`

???+ example "ä¾‹å­"

    === "`package_data`"

        ???+ warning "æ³¨æ„"

            ç”±`package_data`å‚æ•°æŒ‡å®šçš„æ–‡ä»¶å¿…é¡»åŒ…å«åœ¨åŒ…ç›®å½•å†…, ä¸èƒ½æŒ‡å®šåŒ…å«åŒ…å¤–é¢çš„æ–‡ä»¶, å¦‚æœæ–‡ä»¶ä½äºåŒ…å¤–, åˆ™éœ€è¦å…ˆå°†å…¶ç§»åŠ¨åˆ°åŒ…å¤–é¢, ç„¶åä½¿ç”¨`MAINIFEST.in`æŒ‡å®š.
        
        é¡¹ç›®ç»“æ„: 

        ```
        myproject/
        â”œâ”€â”€ mypackage/
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â”œâ”€â”€ module.py
        â”‚   â””â”€â”€ data/
        â”‚       â”œâ”€â”€ config.json
        â”‚       â””â”€â”€ sample_data.csv
        â”œâ”€â”€ README.md
        â””â”€â”€ setup.py
        ```

        `setup.py`æ–‡ä»¶: 

        ```py
        from setuptools import setup, find_packages

        setup(
            name='mypackage',
            version='0.1.0',
            description='A simple example package',
            long_description=open('README.md').read(),
            long_description_content_type='text/markdown',
            author='Your Name',
            author_email='your.email@example.com',
            url='https://github.com/yourname/mypackage',
            packages=find_packages(),
            include_package_data=True,  # å¿…é¡»å¯ç”¨è¿™ä¸ªé€‰é¡¹
            package_data={
                # åŒ…å«åœ¨ mypackage ä¸­çš„æ‰€æœ‰æ–‡ä»¶
                'mypackage': ['data/*.json', 'data/*.csv'],
            },
            python_requires='>=3.6',
        )
        ```

        è¿™ç§æƒ…å†µä¸‹, å¦‚æœä½ è¿è¡Œ`python setup.py sdist`, é»˜è®¤æƒ…å†µä¸‹, æºåˆ†å‘åŒ…åªä¼šåŒ…å«`mypackage`ç›®å½•ä»¥åŠå…¶ä¸­çš„æ¨¡å—ä»¥åŠåŒ…å¤–çš„`README.md`å’Œ`LICENSE`ç­‰å¿…è¦æ–‡ä»¶, å…¶ä»–çš„æ–‡ä»¶, å¦‚`data/config.json`å’Œ`data/sample_data.csv`ä¸ä¼šåŒ…å«åœ¨æºåˆ†å‘åŒ…ä¸­. ä¸ºäº†åŒ…å«ç€è¿™ä¸¤ä¸ªæ–‡ä»¶, ä½¿ç”¨äº†`package_data`æŒ‡å®šè¿™äº›æ–‡ä»¶éœ€è¦åŒ…å«åˆ°æ‰“åŒ…å¥½çš„åŒ…é‡Œé¢. 

    === "`MANIFEST.in`"

        ???+ note "ç¬”è®°"

            ç”±`MANIFEST.in`æŒ‡å®šçš„æ–‡ä»¶å¯ä»¥åœ¨åŒ…å†…ä¹Ÿå¯ä»¥åœ¨åŒ…å¤–.

        é¡¹ç›®ç»“æ„:

        ```
        myproject/
        â”œâ”€â”€ mypackage/
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ module.py
        â”œâ”€â”€ README.md
        â”œâ”€â”€ setup.py
        â””â”€â”€ data/
            â””â”€â”€ dataset.csv
        ```

        `setup.py`æ–‡ä»¶:

        ```py
        from setuptools import setup, find_packages

        setup(
            name='mypackage',
            version='0.1.0',
            description='A simple example package',
            long_description=open('README.md').read(),
            long_description_content_type='text/markdown',
            author='Your Name',
            author_email='your.email@example.com',
            url='https://github.com/yourname/mypackage',
            packages=find_packages(),
            include_package_data=True,
            python_requires='>=3.6',
        )
        ```

        è¿™ç§æƒ…å†µä¸‹, å¦‚æœä½ è¿è¡Œ`python setup.py sdist`, é»˜è®¤æƒ…å†µä¸‹, æºåˆ†å‘åŒ…åªä¼šåŒ…å«`mypackage`ç›®å½•ä»¥åŠå…¶ä¸­çš„æ¨¡å—ä»¥åŠåŒ…å¤–çš„`README.md`å’Œ`LICENSE`ç­‰å¿…è¦æ–‡ä»¶, å…¶ä»–çš„æ–‡ä»¶, å¦‚`data/dataset.csv`ä¸ä¼šåŒ…å«åœ¨æºåˆ†å‘åŒ…ä¸­.

        ä¸ºäº†åŒ…å«ç€ä¸¤ä¸ªæ–‡ä»¶, å¯ä»¥åˆ›å»ºä¸€ä¸ª`MANIFEST.in`, å¹¶æŒ‡å®šè¿™äº›æ–‡ä»¶:

        ```
        recursive-include data *.csv
        ```

        å†æ¬¡è¿è¡Œæ—¶, æºåˆ†å‘åŒ…å°†åŒ…å«: 

        - `mypackage/`ç›®å½•ä»¥åŠå…¶ä¸­çš„æ‰€æœ‰æ¨¡å—ä»¥åŠåŒ…å¤–çš„`README.md`å’Œ`LICENSE`ç­‰å¿…è¦æ–‡ä»¶
        - `data/`ç›®å½•ä»¥åŠå…¶ä¸­æ‰€æœ‰çš„`.csv`æ–‡ä»¶

#### æ‰“åŒ…

å¯ä»¥é€šè¿‡`python setup.py sdist`ç”ŸæˆåŸåˆ†æ³•åŒ…, æˆ–è€…ä½¿ç”¨`python setup.py bdist_wheel`ç”ŸæˆäºŒè¿›åˆ¶åˆ†å‘åŒ…, æ‰“åŒ…åçš„æ–‡ä»¶æ”¾åœ¨distæ–‡ä»¶å¤¹ä¸­, æ‰©å±•ååˆ†åˆ«ä¸º`.tar.gz`å’Œ`.whl`. 

???+ warning "æ³¨æ„"

    åœ¨æ‰“åŒ…ä¹‹å‰, éœ€è¦æ¸…ç†æ‰ä¹‹å‰æ‰€æœ‰æ‰“åŒ…äº§ç”Ÿçš„æ–‡ä»¶: `rm -rf build dist *.egg-info`

#### å‚æ•°

##### æè¿°

æˆ‘ä»¬å¯ä»¥åœ¨`setup.py`ä¸­å°†`long_description`è®¾ç½®ä¸ºé¡¹ç›®ä¸‹çš„`README.md`æ–‡ä»¶:

???+ example "ä¾‹å­"

    ```py
    here = os.path.abspath(os.path.dirname(__file__))

    # Import the README and use it as the long-description.
    # Note: this will only work if 'README.md' is present in your MANIFEST.in file!
    try:
        with io.open(os.path.join(here, 'README.md'), encoding='utf-8') as f:
            long_description = '\n' + f.read()
    except FileNotFoundError:
            long_description = DESCRIPTION
    ```

    `__file__`åœ¨è¿™é‡Œæ—¶`setup.py`çš„æ–‡ä»¶å, `here`ä¿å­˜çš„æ˜¯`setup.py`çš„ç»å¯¹è·¯å¾„. æˆ‘ä»¬å°†`README.md`æ–‡ä»¶è¯»å‡º, ç„¶åèµ‹å€¼ç»™`long_description`. æœ€ååœ¨`setup()`å‡½æ•°ä¸­è®¾ç½®.

##### ç‰ˆæœ¬

æˆ‘ä»¬å¯ä»¥å°†ç‰ˆæœ¬è®¾ç½®ä¸ºåŒ…ç›®å½•ä¸‹`__version__.py`æ–‡ä»¶ä¸­è®¾ç½®çš„ç‰ˆæœ¬:

???+ example "ä¾‹å­"

    `setup.py`æ–‡ä»¶(éƒ¨åˆ†):

    ```py
    # Load the package's __version__.py module as a dictionary.
    about = {}
    if not VERSION:
        project_slug = NAME.lower().replace("-", "_").replace(" ", "_")
        with open(os.path.join(here, project_slug, '__version__.py')) as f:
            exec(f.read(), about)
    else:
        about['__version__'] = VERSION
    ```

    `__version__.py`æ–‡ä»¶:

    ```py
    `__version__.py`æ–‡ä»¶:

    ```py
    # 8b    d8 Yb  dP 88""Yb    db     dP""b8 88  dP    db     dP""b8 888888
    # 88b  d88  YbdP  88__dP   dPYb   dP   `" 88odP    dPYb   dP   `" 88__
    # 88YbdP88   8P   88"""   dP__Yb  Yb      88"Yb   dP__Yb  Yb  "88 88""
    # 88 YY 88  dP    88     dP""""Yb  YboodP 88  Yb dP""""Yb  YboodP 888888

    VERSION = (5, 2, 0)

    __version__ = '.'.join(map(str, VERSION))
    ```

    æ‰¾åˆ°`__version__.py`æ–‡ä»¶ä¹‹å, ä½¿ç”¨`exec()`æ‰§è¡Œé‡Œé¢çš„ä»£ç , ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†ä¸€ä¸ªå‘½åç©ºé—´.

    ???+ example "ä¾‹å­"

        ```py
        code = 'a = 5\nb = 10\nprint(a + b)'
        namespace = {}
        exec(code, namespace)
        print(namespace)  # {'a': 5, 'b': 10}
        ```

    å°†å…¶ç‰ˆæœ¬ä¿å­˜åˆ°`about`è¿™ä¸ªå­—å…¸ä¸­, åœ¨`setup()`å‡½æ•°ä¸­ä½¿ç”¨. å¦‚æœæ²¡æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„è¯, ä½¿ç”¨çš„æ˜¯`setup.py`ä¸­å®šä¹‰çš„`VERSION`å˜é‡çš„å€¼. 

##### ä¾èµ–

`setup()`å‡½æ•°ä¸­çš„`install_requires`ç”¨äºæŒ‡å®šæ ¸å¿ƒä¾èµ–, `extras_require`ç”¨äºæŒ‡å®šå¯é€‰ä¾èµ–. 

- `install_requires`æŒ‡å®šçš„ä¾èµ–æ— è®ºç”¨æˆ·ä»¥ä½•ç§æ–¹å¼å®‰è£…ä½ çš„åŒ…, è¿™äº›éƒ½ä¼šè¢«å®‰è£….

    ???+ example "ä¾‹å­"

        ```py
        from setuptools import setup

        REQUIRED = [
            'numpy>=1.18.0',
            'pandas>=1.0.0',
        ]

        setup(
            ...
            install_requires=REQUIRED,
            ...
        )
        ```

- `extras_require`æŒ‡å®šçš„æ˜¯å¯é€‰ä¾èµ–, å¯ä»¥ä¸ºä½ çš„åŒ…æŒ‡å®šä¸€äº›é¢å¤–çš„ä¾èµ–, ä½†ä¸æ˜¯å¿…éœ€å“, ç”¨æˆ·å¯ä»¥é€‰æ‹©æ˜¯å¦å®‰è£…è¿™äº›ä¾èµ–.

    ???+ example "ä¾‹å­"

        ```py
        from setuptools import setup

        EXTRAS = {
            'dev': ['check-manifest'],
            'test': ['coverage'],
        }

        setup(
            ...
            extras_require=EXTRAS,
            ...
        )
        ```

        ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…å¯é€‰ä¾èµ–: 

        ```sh
        pip install your_package_name[dev]
        pip install your_package_name[test]
        ```

##### å…¶ä»–å‚æ•°

ç®€çŸ­è§£é‡Šä¸€ä¸‹`setup()`å‡½æ•°ä¸­çš„å…¶ä»–å‚æ•°ä»¥åŠå¤ä¹ ä¸€ä¸‹å·²ç»è®²è¿‡çš„å‚æ•°:

- `name`: åŒ…çš„åç§°

    ???+ tip "Tip"

        åŒ…çš„åç§°ä¸­çš„è¿å­—ç¬¦ç”¨`-`, è€Œå®é™…åŒ…çš„åå­—ä¸­çš„è¿å­—ç¬¦ç”¨`_`, å› ä¸ºå¯¼å…¥åŒ…çš„æ—¶å€™å¸¦æœ‰`-`çš„åŒ…éœ€è¦ç”¨åˆ°`importlib`, æ¯”è¾ƒéº»çƒ¦.

- `verision`: åŒ…çš„ç‰ˆæœ¬å·
- `description`: åŒ…çš„ç®€çŸ­æè¿°
- `long_description`: åŒ…çš„è¯¦ç»†æè¿°
- `long_description_content_type`: åŒ…çš„è¯¦ç»†æè¿°çš„æ–‡ä»¶ç±»å‹, ä¸€èˆ¬æ˜¯`text/markdown`
- `author`: åŒ…çš„ä½œè€…
- `author_email`: åŒ…çš„ä½œè€…çš„é‚®ç®±
- `python_requires`: æŒ‡å®šPythonçš„ç‰ˆæœ¬èŒƒå›´
- `url`: åŒ…çš„ä¸»é¡µåœ°å€
- `packages`: æŒ‡å®šè¦æ‰“çš„åŒ…, å¯ä»¥ä½¿ç”¨`find_packages()`å‡½æ•°è‡ªåŠ¨å¯»æ‰¾è¦æ‰“çš„åŒ…
- `py_modules`: å¦‚æœæ˜¯å•ä¸ªæ¨¡å—, ä½¿ç”¨çš„ä¸æ˜¯`package`è€Œæ˜¯`py_modules`
- `entry_point`: å®šä¹‰åŒ…çš„å‘½ä»¤è¡Œè„šæœ¬å…¥å£ç‚¹
- `install_requires`: æŒ‡å®šæ ¸å¿ƒä¾èµ–
- `extras_require`: æŒ‡å®šå¯é€‰ä¾èµ–
- `include_package_data`: è®¾ç½®æ˜¯å¦å¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶
- `license`: åŒ…çš„è®¸å¯è¯
- `classifiers`: åˆ†ç±»æ ‡ç­¾, å¸®åŠ©ç”¨æˆ·æ‰¾åˆ°ä½ çš„åŒ…
- `cmdclass`: æ”¯æŒåœ¨å‘½ä»¤è¡Œè¿è¡Œè‡ªå®šä¹‰å‘½ä»¤

## ä¸Šä¼ 

### `twine`ä¸Šä¼ 

???+ warning "æ³¨æ„"

    éœ€è¦å…ˆå®‰è£…`twine`: `pip install twine`.

å¯ä»¥é€šè¿‡`twine upload dist/*`å‘½ä»¤å°†`dist`æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰åŒ…éƒ½ä¸Šä¼ åˆ°[PYPI](https://pypi.org).

???+ tip "Tip"

    - å¯ä»¥å…ˆä¸Šä¼ åˆ°[TestPYPI](https://test.pypi.org/)æ£€æµ‹ä¸€ä¸‹è‡ªå·±çš„åŒ…æ˜¯å¦æ­£å¸¸, æ˜¯å¦å¯ä»¥é€šè¿‡`pip`ä¸‹è½½å®‰è£…. 

        ```
        twine upload --repository testpypi dist/*
        ```

    - å¯ä»¥åœ¨ç”¨æˆ·ç›®å½•`~`ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶`.pypirc`ä¿å­˜è‡ªå·±çš„Token: 

        ```
        [pypi]
        username = __token__
        password = [token]

        [testpypi]
        username = __token__
        password = [token]
        ```

[^1]: ã€åŸºç¡€ã€‘ä»€ä¹ˆæ˜¯åŒ…ã€æ¨¡å—å’Œåº“ï¼Ÿâ€”Python&å›¾åƒå¤„ç†æ•™ç¨‹ æ–‡æ¡£. (n.d.). Retrieved June 15, 2024, from http://await.fun/PythonTutorial/p06/1.html
[^2]: pythonä¸­importçš„ç”¨æ³•â€”PythonJoy. (n.d.). Retrieved June 15, 2024, from https://joy9191.github.io/16196181446571.html
[^3]: ä»¥python -m siteå‘½ä»¤ä¸ºä¾‹è§£é‡Š-mé€‰é¡¹-CSDNåšå®¢. (n.d.). Retrieved June 16, 2024, from https://blog.csdn.net/jiaxin576/article/details/138574683
[^4]: ä½¿ç”¨æ¨¡å—. (n.d.). Retrieved June 16, 2024, from https://www.liaoxuefeng.com/wiki/1016959663602400/1017455068170048
[^5]: ennethreitz/setup.py: ğŸ“¦ A Humanâ€™s Ultimate Guide to setup.py. (n.d.). Retrieved June 16, 2024, from https://github.com/kennethreitz/setup.py
[^6]: Pythonä¸­__init__.pyæ–‡ä»¶çš„ä½œç”¨â€”å°è“åšå®¢. (n.d.). Retrieved June 18, 2024, from https://www.8kiz.cn/archives/20137.html
[^7]: Pythonå…¥é—¨ä¹‹â€”â€”Packageå†…çš„__main__.pyå’Œ__init__.py_51CTOåšå®¢___main__.pyæ–‡ä»¶. (n.d.). Retrieved June 18, 2024, from https://blog.51cto.com/feishujun/5513660
[^8]: Henry. (2021, May 23). ä¸€æ–‡ç†è§£Pythonå¯¼å…¥æœºåˆ¶. Henryâ€™s Blog. https://hzhu212.github.io/posts/b9859a94/index.html
[^9]: The import system. (n.d.). Python Documentation. Retrieved June 18, 2024, from https://docs.python.org/3/reference/import.html
[^10]: Command line and environment. (n.d.). Python Documentation. Retrieved June 18, 2024, from https://docs.python.org/3/using/cmdline.html